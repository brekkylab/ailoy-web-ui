(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84859,e=>{e.v({className:"geist_a71539c9-module__T19VSG__className",variable:"geist_a71539c9-module__T19VSG__variable"})},94739,e=>{"use strict";var t=e.i(84859);let a={className:t.default.className,style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"}};null!=t.default.variable&&(a.variable=t.default.variable),e.s(["default",0,a])},21554,e=>{e.v({className:"geist_mono_8d43a2aa-module__8Li5zG__className",variable:"geist_mono_8d43a2aa-module__8Li5zG__variable"})},46092,e=>{"use strict";var t=e.i(21554);let a={className:t.default.className,style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"}};null!=t.default.variable&&(a.variable=t.default.variable),e.s(["default",0,a])},48051,e=>{"use strict";var t=e.i(19243),a=e.i(41619),s=e.i(14453),r=e.i(57464),i=e.i(68146),n=e.i(66170),o=e.i(51416),d=e.i(37469),l=e=>{let[,t]=(0,d.tapState)(e.getState);return(0,r.tapEffect)(()=>(t(e.getState()),e.subscribe(()=>{t(e.getState())})),[e]),e.getState()},c=e.i(37036),u=(0,s.resource)(({runtime:e})=>{let t=l(e),a=(0,c.tapEvents)();return(0,r.tapEffect)(()=>{let t=[];for(let s of["switched-to","switched-away"]){let r=e.unstable_on(s,()=>{a.emit(`thread-list-item.${s}`,{threadId:e.getState().id})});t.push(r)}return()=>{for(let e of t)e()}},[e,a]),(0,n.tapApi)({getState:()=>t,switchTo:e.switchTo,rename:e.rename,archive:e.archive,unarchive:e.unarchive,delete:e.delete,generateTitle:e.generateTitle,initialize:e.initialize,detach:e.detach,__internal_getRuntime:()=>e},{key:t.id})}),h=e.i(93722),p=e=>{let t=(0,h.tapResources)(e);return{state:t.map(e=>e.state),api:e=>{let a="index"in e?t[e.index]?.api:t.find(t=>t.key===e.key)?.api;if(!a)throw Error(`tapLookupResources: Resource not found for lookup: ${JSON.stringify(e)}`);return a}}},m=(0,s.resource)(({runtime:e})=>{let t=l(e);return(0,n.tapApi)({getState:()=>t,remove:e.remove,__internal_getRuntime:()=>e},{key:t.id})}),g=(0,s.resource)(({runtime:e,index:t})=>{let a=(0,o.tapMemo)(()=>e.getAttachmentByIndex(t),[e,t]);return(0,i.tapInlineResource)(m({runtime:a}))}),f=(0,s.resource)(({threadIdRef:e,messageIdRef:t,runtime:a})=>{let s=l(a),i=(0,c.tapEvents)();(0,r.tapEffect)(()=>{let s=[];for(let r of["send","attachment-add"]){let n=a.unstable_on(r,()=>{i.emit(`composer.${r}`,{threadId:e.current,...t&&{messageId:t.current}})});s.push(n)}return()=>{for(let e of s)e()}},[a,i,e,t]);let d=p(s.attachments.map((e,t)=>g({runtime:a,index:t},{key:t}))),u=(0,o.tapMemo)(()=>({text:s.text,role:s.role,attachments:d.state,runConfig:s.runConfig,isEditing:s.isEditing,canCancel:s.canCancel,attachmentAccept:s.attachmentAccept,isEmpty:s.isEmpty,type:s.type??"thread"}),[s,d.state]);return(0,n.tapApi)({getState:()=>u,setText:a.setText,setRole:a.setRole,setRunConfig:a.setRunConfig,addAttachment:a.addAttachment,reset:a.reset,clearAttachments:a.clearAttachments,send:a.send,cancel:a.cancel,beginEdit:a.beginEdit??(()=>{throw Error("beginEdit is not supported in this runtime")}),attachment:e=>"id"in e?d.api({key:e.id}):d.api(e),__internal_getRuntime:()=>a})}),b=(0,s.resource)(({runtime:e})=>{let t=l(e);return(0,n.tapApi)({getState:()=>t,addToolResult:t=>e.addToolResult(t),resumeToolCall:t=>e.resumeToolCall(t),__internal_getRuntime:()=>e},{key:"tool-call"===t.type?"toolCallId-"+t.toolCallId:void 0})}),x=(0,s.resource)(({runtime:e,index:t})=>{let a=(0,o.tapMemo)(()=>e.getAttachmentByIndex(t),[e,t]);return(0,i.tapInlineResource)(m({runtime:a}))}),v=(0,s.resource)(({runtime:e,index:t})=>{let a=(0,o.tapMemo)(()=>e.getMessagePartByIndex(t),[e,t]);return(0,i.tapInlineResource)(b({runtime:a}))}),y=(0,s.resource)(({runtime:e,threadIdRef:t})=>{let a=l(e),[s,r]=(0,d.tapState)(!1),[c,u]=(0,d.tapState)(!1),h=(0,o.tapMemo)(()=>({get current(){return e.getState().id}}),[e]),m=(0,i.tapInlineResource)(f({runtime:e.composer,threadIdRef:t,messageIdRef:h})),g=p(a.content.map((t,a)=>v({runtime:e,index:a},{key:a}))),b=p(a.attachments?.map((t,a)=>x({runtime:e,index:a},{key:a}))??[]),y=(0,o.tapMemo)(()=>({...a,parts:g.state,composer:m.state,isCopied:s,isHovering:c}),[a,g.state,m.state,s,c]);return(0,n.tapApi)({getState:()=>y,composer:m.api,reload:t=>e.reload(t),speak:()=>e.speak(),stopSpeaking:()=>e.stopSpeaking(),submitFeedback:t=>e.submitFeedback(t),switchToBranch:t=>e.switchToBranch(t),getCopyText:()=>e.unstable_getCopyText(),part:e=>"index"in e?g.api({index:e.index}):g.api({key:"toolCallId-"+e.toolCallId}),attachment:e=>"id"in e?b.api({key:e.id}):b.api(e),setIsCopied:r,setIsHovering:u,__internal_getRuntime:()=>e},{key:a.id})}),_=(0,s.resource)(({runtime:e,id:t,threadIdRef:a})=>{let s=(0,o.tapMemo)(()=>e.getMessageById(t),[e,t]);return(0,i.tapInlineResource)(y({runtime:s,threadIdRef:a}))}),w=(0,s.resource)(({runtime:e})=>{let t=l(e),a=(0,c.tapEvents)();(0,r.tapEffect)(()=>{let t=[];for(let s of["run-start","run-end","initialize","model-context-update"]){let r=e.unstable_on(s,()=>{let t=e.getState()?.threadId||"unknown";a.emit(`thread.${s}`,{threadId:t})});t.push(r)}return()=>{for(let e of t)e()}},[e]);let s=(0,o.tapMemo)(()=>({get current(){return e.getState().threadId}}),[e]),d=(0,i.tapInlineResource)(f({runtime:e.composer,threadIdRef:s})),u=p(t.messages.map(t=>_({runtime:e,id:t.id,threadIdRef:s},{key:t.id}))),h=(0,o.tapMemo)(()=>({isDisabled:t.isDisabled,isLoading:t.isLoading,isRunning:t.isRunning,capabilities:t.capabilities,state:t.state,suggestions:t.suggestions,extras:t.extras,speech:t.speech,composer:d.state,messages:u.state}),[t,u,d.state]);return(0,n.tapApi)({getState:()=>h,composer:d.api,append:e.append,startRun:e.startRun,unstable_resumeRun:e.unstable_resumeRun,cancelRun:e.cancelRun,getModelContext:e.getModelContext,export:e.export,import:e.import,reset:e.reset,stopSpeaking:e.stopSpeaking,startVoice:async()=>{throw Error("startVoice is not supported in this runtime")},stopVoice:async()=>{throw Error("stopVoice is not supported in this runtime")},message:e=>"id"in e?u.api({key:e.id}):u.api(e),__internal_getRuntime:()=>e})}),T=(0,s.resource)(({runtime:e,id:t})=>{let a=(0,o.tapMemo)(()=>e.getItemById(t),[e,t]);return(0,i.tapInlineResource)(u({runtime:a}))}),S=(0,s.resource)(({runtime:e,__internal_assistantRuntime:t})=>{let a=l(e),s=(0,i.tapInlineResource)(w({runtime:e.main})),r=p(Object.keys(a.threadItems).map(t=>T({runtime:e,id:t},{key:t}))),d=(0,o.tapMemo)(()=>({mainThreadId:a.mainThreadId,newThreadId:a.newThread??null,isLoading:a.isLoading,threadIds:a.threads,archivedThreadIds:a.archivedThreads,threadItems:r.state,main:s.state}),[a,r.state,s.state]);return(0,n.tapApi)({getState:()=>d,thread:()=>s.api,item:e=>{if("main"===e)return r.api({key:d.mainThreadId});if("id"in e)return r.api({key:e.id});let{index:t,archived:a=!1}=e,s=a?d.archivedThreadIds[t]:d.threadIds[t];return r.api({key:s})},switchToThread:t=>{e.switchToThread(t)},switchToNewThread:()=>{e.switchToNewThread()},__internal_getAssistantRuntime:()=>t})}),I=e.i(92219),j=(0,s.resource)(e=>{let t=(0,I.tapModelContext)();return(0,r.tapEffect)(()=>e.registerModelContextProvider(t),[e,t]),(0,i.tapInlineResource)(S({runtime:e.threads,__internal_assistantRuntime:e}))}),M=e.i(54011),C=(0,t.memo)(({children:e,runtime:t})=>{let s=(0,a.useAssistantApi)({threads:j(t)}),r=t._core?.RenderComponent;return(0,M.jsxs)(a.AssistantProvider,{api:s,children:[r&&(0,M.jsx)(r,{}),e]})});e.s(["AssistantRuntimeProvider",()=>C],48051)},41941,e=>{"use strict";function t(e,t){if("*"===t)return!0;let a=t.split(",").map(e=>e.trim().toLowerCase()),s="."+e.name.split(".").pop().toLowerCase(),r=e.type.toLowerCase();for(let e of a){if(e.startsWith(".")&&e===s||e.includes("/")&&e===r)return!0;if(("image/*"===e||"video/*"===e||"audio/*"===e)&&e.endsWith("/*")){let t=e.split("/")[0];if(r.startsWith(t+"/"))return!0}}return!1}var a=class{_adapters;accept;constructor(e){this._adapters=e;const t=e.findIndex(e=>"*"===e.accept);if(-1!==t){if(t!==e.length-1)throw Error("A wildcard adapter (handling all files) can only be specified as the last adapter.");this.accept="*"}else this.accept=e.map(e=>e.accept).join(",")}add(e){for(let a of this._adapters)if(t(e.file,a.accept))return a.add(e);throw Error("No matching adapter found for file")}async send(e){for(let a of this._adapters.slice())if(t(e.file,a.accept))return a.send(e);throw Error("No matching adapter found for attachment")}async remove(e){for(let a of this._adapters.slice())if(t({name:e.name,type:e.contentType},a.accept))return a.remove(e);throw Error("No matching adapter found for attachment")}};e.s(["CompositeAttachmentAdapter",()=>a])},97825,e=>{"use strict";var t=class{accept="image/*";async add(e){return{id:e.file.name,type:"image",name:e.file.name,contentType:e.file.type,file:e.file,status:{type:"requires-action",reason:"composer-send"}}}async send(e){return{...e,status:{type:"complete"},content:[{type:"image",image:await a(e.file)}]}}async remove(){}},a=e=>new Promise((t,a)=>{let s=new FileReader;s.onload=()=>t(s.result),s.onerror=e=>a(e),s.readAsDataURL(e)});e.s(["SimpleImageAttachmentAdapter",()=>t])},74043,e=>{"use strict";var t=class{accept="text/plain,text/html,text/markdown,text/csv,text/xml,text/json,text/css";async add(e){return{id:e.file.name,type:"document",name:e.file.name,contentType:e.file.type,file:e.file,status:{type:"requires-action",reason:"composer-send"}}}async send(e){return{...e,status:{type:"complete"},content:[{type:"text",text:`<attachment name=${e.name}>
${await a(e.file)}
</attachment>`}]}}async remove(){}},a=e=>new Promise((t,a)=>{let s=new FileReader;s.onload=()=>t(s.result),s.onerror=e=>a(e),s.readAsText(e)});e.s(["SimpleTextAttachmentAdapter",()=>t])},85737,e=>{"use strict";var t=class{cache=new WeakMap;convertMessages(e,t){return e.map((e,a)=>{let s=t(this.cache.get(e),e,a);return this.cache.set(e,s),s})}};e.s(["ThreadMessageConverter",()=>t])},980,e=>{"use strict";var t=e.i(19243),a=e.i(85737),s=e.i(65291),r=e.i(95231),i=e.i(92695),n=({callback:e,messages:n,isRunning:d,joinStrategy:l,metadata:c})=>{let u=(0,t.useMemo)(()=>({metadata:c??{},callback:e,callbackCache:new WeakMap,chunkCache:new WeakMap,converterCache:new a.ThreadMessageConverter}),[e,c]);return(0,t.useMemo)(()=>{let e=[];for(let t of n){let a=u.callbackCache.get(t);if(!a){let e=u.callback(t,u.metadata);a={input:t,outputs:Array.isArray(e)?e:[e]},u.callbackCache.set(t,a)}e.push(a)}let t=((e,t)=>{let a=[],s=!1,r=!1,i=[],n=[],o=()=>{n.length&&a.push({inputs:i,outputs:n}),i=[],n=[],s=!1,r=!1};for(let a of e)for(let e of a.outputs)(r&&"tool"!==e.role||!s||"user"===e.role||"system"===e.role)&&o(),s="assistant"===e.role||"tool"===e.role,i.at(-1)!==a.input&&i.push(a.input),n.push(e),"assistant"===e.role&&(e.convertConfig?.joinStrategy==="none"||"none"===t)&&(r=!0);return o(),a})(e,l).map(e=>{let t=e.outputs[0];if(!t)return e;let a=u.chunkCache.get(t);return a&&o(a.outputs,e.outputs)?a:(u.chunkCache.set(t,e),e)}),a=u.converterCache.convertMessages(t,(e,a,n)=>{let l=n===t.length-1,c=(e=>{let t={role:"assistant",content:[]};for(let a of e)if("tool"===a.role){let e=t.content.findIndex(e=>"tool-call"===e.type&&e.toolCallId===a.toolCallId);if(-1!==e){let r=t.content[e];if(void 0!==a.toolName&&r.toolName!==a.toolName)throw Error(`Tool call name ${a.toolCallId} ${a.toolName} does not match existing tool call ${r.toolName}`);t.content[e]={...r,...{[s.symbolInnerMessage]:[...r[s.symbolInnerMessage]??[],a]},result:a.result,artifact:a.artifact,isError:a.isError,messages:a.messages}}else throw Error(`Tool call ${a.toolCallId} ${a.toolName} not found in assistant message`)}else{let e=a.role,r=("string"==typeof a.content?[{type:"text",text:a.content}]:a.content).map(e=>({...e,...{[s.symbolInnerMessage]:[a]}}));switch(e){case"system":case"user":return{...a,content:r};case"assistant":0===t.content.length&&(t.id=a.id,t.createdAt??=a.createdAt,t.status??=a.status,a.attachments&&(t.attachments=[...t.attachments??[],...a.attachments]),a.metadata&&(t.metadata??={},a.metadata.unstable_state&&(t.metadata.unstable_state=a.metadata.unstable_state),a.metadata.unstable_annotations&&(t.metadata.unstable_annotations=[...t.metadata.unstable_annotations??[],...a.metadata.unstable_annotations]),a.metadata.unstable_data&&(t.metadata.unstable_data=[...t.metadata.unstable_data??[],...a.metadata.unstable_data]),a.metadata.steps&&(t.metadata.steps=[...t.metadata.steps??[],...a.metadata.steps]),a.metadata.custom&&(t.metadata.custom={...t.metadata.custom??{},...a.metadata.custom}),a.metadata.submittedFeedback&&(t.metadata.submittedFeedback=a.metadata.submittedFeedback))),t.content.push(...r);break;default:throw Error(`Unknown message role: ${e}`)}}return t})(a.outputs),h="object"==typeof c.content&&c.content.some(e=>"tool-call"===e.type&&void 0===e.result),p="object"==typeof c.content&&c.content.some(e=>"tool-call"===e.type&&void 0===e.result),m=(0,i.getAutoStatus)(l,d,h,p,l?u.metadata.error:void 0);if(e&&("assistant"!==e.role||!(0,i.isAutoStatus)(e.status)||e.status===m)&&o((0,s.getExternalStoreMessages)(e),a.inputs))return e;let g=(0,r.fromThreadMessageLike)(c,n.toString(),m);return g[s.symbolInnerMessage]=a.inputs,g});return a[s.symbolInnerMessage]=n,a},[u,n,d,l])},o=(e,t)=>{if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0};e.s(["useExternalMessageConverter",()=>n])},82017,e=>{"use strict";var t=e.i(19243),a=e.i(58249),s=Object.freeze([]),r="DEFAULT_THREAD_ID",i=Object.freeze([r]),n=Object.freeze({id:r,remoteId:void 0,externalId:void 0,status:"regular"}),o=Promise.resolve(),d=Object.freeze({[r]:n}),l=class{constructor(e={},t){this.adapter=e,this.threadFactory=t,this._mainThread=this.threadFactory(),this.__internal_setAdapter(e,!0)}_mainThreadId=r;_threads=i;_archivedThreads=s;_threadData=d;get isLoading(){return this.adapter.isLoading??!1}get newThreadId(){}get threadIds(){return this._threads}get archivedThreadIds(){return this._archivedThreads}get threadData(){return this._threadData}getLoadThreadsPromise(){return o}_mainThread;get mainThreadId(){return this._mainThreadId}getMainThreadRuntimeCore(){return this._mainThread}getThreadRuntimeCore(){throw Error("Method not implemented.")}getItemById(e){for(let t of this.adapter.threads??[])if(t.id===e)return t;for(let t of this.adapter.archivedThreads??[])if(t.id===e)return t;if(e===r)return n}__internal_setAdapter(e,t=!1){let a=this.adapter;this.adapter=e;let i=e.threadId??r,n=e.threads??s,o=e.archivedThreads??s,l=a.threadId??r,c=a.threads??s,u=a.archivedThreads??s;(t||l!==i||c!==n||u!==o)&&(this._threadData={...d,...Object.fromEntries(e.threads?.map(e=>[e.id,{...e,remoteId:e.remoteId,externalId:e.externalId,status:"regular"}])??[]),...Object.fromEntries(e.archivedThreads?.map(e=>[e.id,{...e,remoteId:e.remoteId,externalId:e.externalId,status:"archived"}])??[])},c!==n&&(this._threads=this.adapter.threads?.map(e=>e.id)??s),u!==o&&(this._archivedThreads=this.adapter.archivedThreads?.map(e=>e.id)??s),l!==i&&(this._mainThreadId=i,this._mainThread=this.threadFactory()),this._notifySubscribers())}async switchToThread(e){if(this._mainThreadId===e)return;let t=this.adapter.onSwitchToThread;if(!t)throw Error("External store adapter does not support switching to thread");t(e)}async switchToNewThread(){let e=this.adapter.onSwitchToNewThread;if(!e)throw Error("External store adapter does not support switching to new thread");e()}async rename(e,t){let a=this.adapter.onRename;if(!a)throw Error("External store adapter does not support renaming");a(e,t)}async detach(){}async archive(e){let t=this.adapter.onArchive;if(!t)throw Error("External store adapter does not support archiving");t(e)}async unarchive(e){let t=this.adapter.onUnarchive;if(!t)throw Error("External store adapter does not support unarchiving");t(e)}async delete(e){let t=this.adapter.onDelete;if(!t)throw Error("External store adapter does not support deleting");t(e)}initialize(e){return Promise.resolve({remoteId:e,externalId:void 0})}generateTitle(){throw Error("Method not implemented.")}_subscriptions=new Set;subscribe(e){return this._subscriptions.add(e),()=>this._subscriptions.delete(e)}_notifySubscribers(){for(let e of this._subscriptions)e()}},c=e.i(65291),u=e.i(85737),h=e.i(92695),p=e.i(95231),m=e.i(61129),g=e.i(87886),f=e.i(71374),b=e.i(30634),x=class extends b.BaseComposerRuntimeCore{constructor(e,t,{parentId:a,message:s}){super(),this.runtime=e,this.endEditCallback=t,this._parentId=a,this._sourceId=s.id,this._previousText=(0,m.getThreadMessageText)(s),this.setText(this._previousText),this.setRole(s.role),this.setAttachments(s.attachments??[]),this._nonTextParts=s.content.filter(e=>"text"!==e.type),this.setRunConfig({...e.composer.runConfig})}get canCancel(){return!0}getAttachmentAdapter(){return this.runtime.adapters?.attachments}_nonTextParts;_previousText;_parentId;_sourceId;async handleSend(e){(0,m.getThreadMessageText)(e)!==this._previousText&&this.runtime.append({...e,content:[...e.content,...this._nonTextParts],parentId:this._parentId,sourceId:this._sourceId}),this.handleCancel()}handleCancel(){this.endEditCallback(),this._notifySubscribers()}},v=class{constructor(e){this._contextProvider=e}_subscriptions=new Set;_isInitialized=!1;repository=new g.MessageRepository;get messages(){return this.repository.getMessages()}get state(){let e;for(let t of this.messages)if("assistant"===t.role){e=t;break}return e?.metadata.unstable_state??null}composer=new f.DefaultThreadComposerRuntimeCore(this);getModelContext(){return this._contextProvider.getModelContext()}_editComposers=new Map;getEditComposer(e){return this._editComposers.get(e)}beginEdit(e){if(this._editComposers.has(e))throw Error("Edit already in progress");this._editComposers.set(e,new x(this,()=>this._editComposers.delete(e),this.repository.getMessage(e))),this._notifySubscribers()}getMessageById(e){try{return this.repository.getMessage(e)}catch{return}}getBranches(e){return this.repository.getBranches(e)}switchToBranch(e){this.repository.switchToBranch(e),this._notifySubscribers()}_notifySubscribers(){for(let e of this._subscriptions)e()}_notifyEventSubscribers(e){let t=this._eventSubscribers.get(e);if(t)for(let e of t)e()}subscribe(e){return this._subscriptions.add(e),()=>this._subscriptions.delete(e)}submitFeedback({messageId:e,type:t}){let a=this.adapters?.feedback;if(!a)throw Error("Feedback adapter not configured");let{message:s,parentId:r}=this.repository.getMessage(e);if(a.submit({message:s,type:t}),"assistant"===s.role){let e={...s,metadata:{...s.metadata,submittedFeedback:{type:t}}};this.repository.addOrUpdateMessage(r,e)}this._notifySubscribers()}_stopSpeaking;speech;speak(e){let t=this.adapters?.speech;if(!t)throw Error("Speech adapter not configured");let{message:a}=this.repository.getMessage(e);this._stopSpeaking?.();let s=t.speak((0,m.getThreadMessageText)(a)),r=s.subscribe(()=>{"ended"===s.status.type?(this._stopSpeaking=void 0,this.speech=void 0):this.speech={messageId:e,status:s.status},this._notifySubscribers()});this.speech={messageId:e,status:s.status},this._notifySubscribers(),this._stopSpeaking=()=>{s.cancel(),r(),this.speech=void 0,this._stopSpeaking=void 0}}stopSpeaking(){if(!this._stopSpeaking)throw Error("No message is being spoken");this._stopSpeaking(),this._notifySubscribers()}ensureInitialized(){this._isInitialized||(this._isInitialized=!0,this._notifyEventSubscribers("initialize"))}export(){return this.repository.export()}import(e){this.ensureInitialized(),this.repository.clear(),this.repository.import(e),this._notifySubscribers()}reset(e){this.import(g.ExportedMessageRepository.fromArray(e??[]))}_eventSubscribers=new Map;unstable_on(e,t){if("model-context-update"===e)return this._contextProvider.subscribe?.(t)??(()=>{});let a=this._eventSubscribers.get(e);return a?a.add(t):this._eventSubscribers.set(e,new Set([t])),()=>{this._eventSubscribers.get(e).delete(t)}}},y=Object.freeze([]),_=class extends v{_assistantOptimisticId=null;_capabilities={switchToBranch:!1,switchBranchDuringRun:!1,edit:!1,reload:!1,cancel:!1,unstable_copy:!1,speech:!1,attachments:!1,feedback:!1};get capabilities(){return this._capabilities}_messages;isDisabled;get isLoading(){return this._store.isLoading??!1}get messages(){return this._messages}get state(){return this._store.state??super.state}get adapters(){return this._store.adapters}suggestions=[];extras=void 0;_converter=new u.ThreadMessageConverter;_store;beginEdit(e){if(!this._store.onEdit)throw Error("Runtime does not support editing.");super.beginEdit(e)}constructor(e,t){super(e),this.__internal_setAdapter(t)}__internal_setAdapter(e){let t,a;if(this._store===e)return;let s=e.isRunning??!1;this.isDisabled=e.isDisabled??!1;let r=this._store;if(this._store=e,this.extras=e.extras,this.suggestions=e.suggestions??y,this._capabilities={switchToBranch:void 0!==this._store.setMessages,switchBranchDuringRun:!1,edit:void 0!==this._store.onEdit,reload:void 0!==this._store.onReload,cancel:void 0!==this._store.onCancel,speech:this._store.adapters?.speech!==void 0,unstable_copy:this._store.unstable_capabilities?.copy!==!1,attachments:!!this._store.adapters?.attachments,feedback:!!this._store.adapters?.feedback},e.messageRepository){if(r&&r.isRunning===e.isRunning&&r.messageRepository===e.messageRepository)return void this._notifySubscribers();this.repository.clear(),this._assistantOptimisticId=null,this.repository.import(e.messageRepository),t=this.repository.getMessages()}else if(e.messages){if(r){if(r.convertMessage!==e.convertMessage)this._converter=new u.ThreadMessageConverter;else if(r.isRunning===e.isRunning&&r.messages===e.messages)return void this._notifySubscribers()}t=e.convertMessage?this._converter.convertMessages(e.messages,(t,a,r)=>{if(!e.convertMessage)return a;let i=r===e.messages.length-1,n=(0,h.getAutoStatus)(i,s,!1,!1,void 0);if(t&&("assistant"!==t.role||!(0,h.isAutoStatus)(t.status)||t.status===n))return t;let o=e.convertMessage(a,r),d=(0,p.fromThreadMessageLike)(o,r.toString(),n);return d[c.symbolInnerMessage]=a,d}):e.messages;for(let e=0;e<t.length;e++){let a=t[e],s=t[e-1];this.repository.addOrUpdateMessage(s?.id??null,a)}}else throw Error("ExternalStoreAdapter must provide either 'messages' or 'messageRepository'");t.length>0&&this.ensureInitialized(),(r?.isRunning??!1)!==(e.isRunning??!1)&&(e.isRunning?this._notifyEventSubscribers("run-start"):this._notifyEventSubscribers("run-end")),this._assistantOptimisticId&&(this.repository.deleteMessage(this._assistantOptimisticId),this._assistantOptimisticId=null),a=t,s&&a[a.length-1]?.role!=="assistant"&&(this._assistantOptimisticId=this.repository.appendOptimisticMessage(t.at(-1)?.id??null,{role:"assistant",content:[]})),this.repository.resetHead(this._assistantOptimisticId??t.at(-1)?.id??null),this._messages=this.repository.getMessages(),this._notifySubscribers()}switchToBranch(e){if(!this._store.setMessages)throw Error("Runtime does not support switching branches.");this._store.isRunning||(this.repository.switchToBranch(e),this.updateMessages(this.repository.getMessages()))}async append(e){if(e.parentId!==(this.messages.at(-1)?.id??null)){if(!this._store.onEdit)throw Error("Runtime does not support editing messages.");await this._store.onEdit(e)}else await this._store.onNew(e)}async startRun(e){if(!this._store.onReload)throw Error("Runtime does not support reloading messages.");await this._store.onReload(e.parentId,e)}async resumeRun(e){if(!this._store.onResume)throw Error("Runtime does not support resuming runs.");await this._store.onResume(e)}unstable_loadExternalState(e){if(!this._store.onLoadExternalState)throw Error("Runtime does not support importing states.");this._store.onLoadExternalState(e)}cancelRun(){if(!this._store.onCancel)throw Error("Runtime does not support cancelling runs.");this._store.onCancel(),this._assistantOptimisticId&&(this.repository.deleteMessage(this._assistantOptimisticId),this._assistantOptimisticId=null);let e=this.repository.getMessages(),t=e[e.length-1];t?.role==="user"&&t.id===e.at(-1)?.id?(this.repository.deleteMessage(t.id),this.composer.text.trim()||this.composer.setText((0,m.getThreadMessageText)(t)),e=this.repository.getMessages()):this._notifySubscribers(),setTimeout(()=>{this.updateMessages(e)},0)}addToolResult(e){if(!this._store.onAddToolResult&&!this._store.onAddToolResult)throw Error("Runtime does not support tool results.");this._store.onAddToolResult?.(e)}resumeToolCall(e){if(!this._store.onResumeToolCall)throw Error("Runtime does not support resuming tool calls.");this._store.onResumeToolCall(e)}reset(e){let t=new g.MessageRepository;t.import(g.ExportedMessageRepository.fromArray(e??[])),this.updateMessages(t.getMessages())}import(e){this._assistantOptimisticId=null,super.import(e),this._store.onImport&&this._store.onImport(this.repository.getMessages())}updateMessages=e=>{void 0!==this._store.convertMessage?this._store.setMessages?.(e.flatMap(c.getExternalStoreMessage).filter(e=>null!=e)):this._store.setMessages?.(e)}},w=e=>e.adapters?.threadList??{},T=class extends a.BaseAssistantRuntimeCore{threads;constructor(e){super(),this.threads=new l(w(e),()=>new _(this._contextProvider,e))}setAdapter(e){this.threads.__internal_setAdapter(w(e)),this.threads.getMainThreadRuntimeCore().__internal_setAdapter(e)}},S=e.i(46850);e.i(54011);var I=(0,t.createContext)(null),j=e=>{let[a]=(0,t.useState)(()=>new T(e));(0,t.useEffect)(()=>{a.setAdapter(e)});let{modelContext:s}=(0,t.useContext)(I)??{};return(0,t.useEffect)(()=>{if(s)return a.registerModelContextProvider(s)},[s,a]),(0,t.useMemo)(()=>new S.AssistantRuntimeImpl(a),[a])};e.s(["useExternalStoreRuntime",()=>j],82017)},77536,e=>{"use strict";function t(e){switch(e.type){case"text":return{type:"text",text:e.text};case"value":return{type:"text",text:e.value?.toString()??""};case"image":{let a;if("binary"===e.image.type){var t;let s,r;t=e.image.data,s="",t.forEach(e=>{s+=String.fromCharCode(e)}),r=btoa(s),a=`data:image/png;base64,${r}`}else a=e.image.url;return{type:"image",image:a}}case"function":{let t={type:"tool-call",toolCallId:e.id,toolName:e.function.name};return"string"==typeof e.function.arguments?t.argsText=e.function.arguments:"object"==typeof e.function.arguments&&(t.args=e.function.arguments),t}}}function a(e){switch(e.role){case"system":return{role:"system",content:e.contents.map(e=>t(e))};case"user":return{role:"user",content:e.contents.map(e=>t(e))};case"assistant":{let a=[];return e.thinking&&a.push({type:"reasoning",text:e.thinking}),a=[...a,...e.contents.map(e=>t(e))],e.tool_calls&&e.tool_calls.length>0&&(a=[...a,...e.tool_calls.map(e=>t(e))]),{role:"assistant",content:a}}case"tool":{let t,a=e.contents[0];return t="text"===a.type?a.text:"value"===a.type?JSON.stringify(a.value):"",{role:"tool",toolCallId:e.id,result:t}}}}function s(e){switch(e.type){case"text":return{type:"text",text:e.text};case"value":return{type:"text",text:e.value?.toString()??""};case"function":if("verbatim"===e.function.type)return{type:"text",text:e.function.text};if("with_string_args"===e.function.type);return{type:"text",text:`{"name": "${e.function.name}", "arguments": ${e.function.arguments}}`};case"null":return{type:"text",text:""}}}function r(e){switch(e.role){case"assistant":{let t=[];return e.thinking&&t.push({type:"reasoning",text:e.thinking}),t=[...t,...e.contents.map(e=>s(e))],e.tool_calls.length>0&&(t=[...t,...e.tool_calls.map(e=>s(e))]),{role:"assistant",content:t}}case"tool":{let t=s(e.contents[0]).text;return{role:"tool",toolCallId:e.id,result:t}}default:return{role:"assistant",content:[]}}}function i(e){let t=[];for(let a of e){if("tool"===a.role)continue;let e=[];for(let t of a.content)if("string"==typeof t)e.push({type:"text",text:t});else if("text"===t.type)e.push({type:"text",text:t.text});else if("reasoning"===t.type);else if("tool-call"===t.type);else if("image"===t.type)e.push({type:"image",image:{type:"url",url:t.image}});else throw Error("Unsupported content type");t.push({role:a.role,contents:e})}return t}e.s(["convertMessage",()=>a,"convertMessageDelta",()=>r,"restoreMessages",()=>i])},86444,e=>e.a(async(t,a)=>{try{var s=e.i(54011),r=e.i(19243),i=e.i(69798),n=t([i]);[i]=n.then?(await n)():n;let l=(0,r.createContext)({currentThreadId:"default",setCurrentThreadId:()=>{},threads:new Map,setThreads:()=>{},currentThreadMessages:[],appendThreadMessage:()=>{},renameThread:()=>{},threadListAdapter:{}});function o({children:e}){let[t,a]=(0,r.useState)([{id:"default",status:"regular",title:"New Chat"}]),[n,o]=(0,r.useState)(new Map([["default",[]]])),[d,c]=(0,r.useState)("default"),u=(0,r.useMemo)(()=>n.get(d)??[],[d,n]),{isModelLoading:h,selectedModel:p}=(0,i.useAiloyAgentContext)();return(0,r.useEffect)(()=>{a([{id:"default",status:"regular",title:"New Chat"}]),o(new Map([["default",[]]]))},[p]),(0,s.jsx)(l.Provider,{value:{currentThreadId:d,setCurrentThreadId:c,threads:n,setThreads:o,currentThreadMessages:u,appendThreadMessage:(e,t)=>{o(a=>{let s=new Map(a),r=s.get(e)??[];return s.set(e,[...r,t]),s})},renameThread:(e,t)=>{a(a=>a.map(a=>a.id===e?{...a,title:t}:a))},threadListAdapter:{threadId:d,threads:t,isLoading:h,onSwitchToNewThread:()=>{let e=`thread-${Date.now()}`;a(t=>[...t,{id:e,status:"regular",title:"New Chat"}]),o(t=>new Map(t).set(e,[])),c(e)},onSwitchToThread:e=>{c(e)},onRename:(e,t)=>{a(a=>a.map(a=>a.id===e?{...a,title:t}:a))},onDelete:e=>{a(t=>t.filter(t=>t.id!==e)),o(t=>{let a=new Map(t);return a.delete(e),a}),d===e&&c("default")}}},children:e})}function d(){let e=(0,r.useContext)(l);if(!e)throw Error("useThreadContext must be used within ThreadProvider");return e}e.s(["ThreadProvider",()=>o,"useThreadContext",()=>d]),a()}catch(e){a(e)}},!1),8355,e=>e.a(async(t,a)=>{try{var s=e.i(54011),r=e.i(48051),i=e.i(41941),n=e.i(97825),o=e.i(74043),d=e.i(980),l=e.i(82017),c=e.i(11639),u=e.i(19243),h=e.i(77536),p=e.i(69798),m=e.i(86444),g=t([c,p,m]);function f({children:e}){let[t,a]=(0,u.useState)(null),[g,f]=(0,u.useState)(!1),{agentInitialized:b,agentRunConfig:x,runAgent:v,systemPrompt:y}=(0,p.useAiloyAgentContext)(),{currentThreadId:_,currentThreadMessages:w,appendThreadMessage:T,renameThread:S,threadListAdapter:I}=(0,m.useThreadContext)();(0,u.useEffect)(()=>(p.agentStreamEventTarget.addEventListener("agent-stream-delta",M),p.agentStreamEventTarget.addEventListener("agent-stream-finished",C),()=>{p.agentStreamEventTarget.removeEventListener("agent-stream-delta",M),p.agentStreamEventTarget.removeEventListener("agent-stream-finished",C)}),[_]);let j=null,M=async e=>{let{delta:t,finish_reason:s}=e.detail;if(j=null===j?t:c.accumulateMessageDelta(j,t),a({...j}),void 0!==s){let e=c.finishMessageDelta(j);T(_,(0,h.convertMessage)(e)),a(null),j=null}},C=()=>{f(!1)},k=(0,u.useCallback)(async e=>{if(!b)throw Error("Agent is not initialized yet");let t=[];if(void 0!==e.attachments){for(let a of e.attachments)if("image"===a.type){let e=await a.file.arrayBuffer(),s=new Uint8Array(e),r=c.imageFromBytes(s);t.push(r)}}if(e.content[0]?.type!=="text")throw Error("Only text messages are supported");t.push({type:"text",text:e.content[0].text});let a={role:"user",contents:t};T(_,(0,h.convertMessage)(a)),0===w.length&&S(_,e.content[0].text.substring(0,30));let s=[...(0,h.restoreMessages)(w),a];""!==y&&(s=[{role:"system",contents:[{type:"text",text:y}]},...s]),v(s,x),f(!0)},[b,_,w,x,y,T,S,v]),R=(0,u.useMemo)(()=>{let e=w;if(null!==t){let a=(0,h.convertMessageDelta)(t);e=[...e,a]}return e},[w,t]),E=(0,l.useExternalStoreRuntime)({isDisabled:!b,isRunning:g,messages:(0,d.useExternalMessageConverter)({messages:R,callback:e=>e,isRunning:g}),onNew:k,adapters:{attachments:new i.CompositeAttachmentAdapter([new n.SimpleImageAttachmentAdapter,new o.SimpleTextAttachmentAdapter]),threadList:I}});return(0,s.jsx)(r.AssistantRuntimeProvider,{runtime:E,children:e})}[c,p,m]=g.then?(await g)():g,e.s(["AiloyRuntimeProvider",()=>f]),a()}catch(e){a(e)}},!1),93654,(e,t,a)=>{t.exports=e.r(81168)},99128,e=>{"use strict";var t=e.i(54011),a=e.i(19243),s=e.i(4635),r="horizontal",i=["horizontal","vertical"],n=a.forwardRef((e,a)=>{var n;let{decorative:o,orientation:d=r,...l}=e,c=(n=d,i.includes(n))?d:r;return(0,t.jsx)(s.Primitive.div,{"data-orientation":c,...o?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...l,ref:a})});n.displayName="Separator";var o=e.i(7071);function d({className:e,orientation:a="horizontal",decorative:s=!0,...r}){return(0,t.jsx)(n,{"data-slot":"separator",decorative:s,orientation:a,className:(0,o.cn)("shrink-0 bg-border data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}e.s(["Separator",()=>d],99128)},77494,e=>{"use strict";var t=e.i(54011),a=e.i(19243),s=e.i(8415),r=e.i(81471);let i=(0,e.i(85739).default)("panel-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);var n=e.i(7071),o=e.i(25111);e.i(76586),e.i(99128);var d=e.i(86578),l=e.i(11180);function c({...e}){return(0,t.jsx)(d.Root,{"data-slot":"sheet",...e})}function u({...e}){return(0,t.jsx)(d.Portal,{"data-slot":"sheet-portal",...e})}function h({className:e,...a}){return(0,t.jsx)(d.Overlay,{"data-slot":"sheet-overlay",className:(0,n.cn)("fixed inset-0 z-50 bg-black/50 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:animate-in data-[state=open]:fade-in-0",e),...a})}function p({className:e,children:a,side:s="right",...r}){return(0,t.jsxs)(u,{children:[(0,t.jsx)(h,{}),(0,t.jsxs)(d.Content,{"data-slot":"sheet-content",className:(0,n.cn)("fixed z-50 flex flex-col gap-4 bg-background shadow-lg transition ease-in-out data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:animate-in data-[state=open]:duration-500","right"===s&&"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm","left"===s&&"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm","top"===s&&"inset-x-0 top-0 h-auto border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top","bottom"===s&&"inset-x-0 bottom-0 h-auto border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",e),...r,children:[a,(0,t.jsxs)(d.Close,{className:"absolute top-4 right-4 rounded-xs opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,t.jsx)(l.XIcon,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"sheet-header",className:(0,n.cn)("flex flex-col gap-1.5 p-4",e),...a})}function g({className:e,...a}){return(0,t.jsx)(d.Title,{"data-slot":"sheet-title",className:(0,n.cn)("font-semibold text-foreground",e),...a})}function f({className:e,...a}){return(0,t.jsx)(d.Description,{"data-slot":"sheet-description",className:(0,n.cn)("text-sm text-muted-foreground",e),...a})}var b=e.i(65875);let x=a.createContext(null);function v(){let e=a.useContext(x);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}function y({defaultOpen:e=!0,open:s,onOpenChange:r,className:i,style:o,children:d,...l}){let c=function(){let[e,t]=a.useState(void 0);return a.useEffect(()=>{let e=window.matchMedia("(max-width: 767px)"),a=()=>{t(window.innerWidth<768)};return e.addEventListener("change",a),t(window.innerWidth<768),()=>e.removeEventListener("change",a)},[]),!!e}(),[u,h]=a.useState(!1),[p,m]=a.useState(e),g=s??p,f=a.useCallback(e=>{let t="function"==typeof e?e(g):e;r?r(t):m(t),document.cookie=`sidebar_state=${t}; path=/; max-age=604800`},[r,g]),v=a.useCallback(()=>c?h(e=>!e):f(e=>!e),[c,f,h]);a.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),v())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[v]);let y=g?"expanded":"collapsed",_=a.useMemo(()=>({state:y,open:g,setOpen:f,isMobile:c,openMobile:u,setOpenMobile:h,toggleSidebar:v}),[y,g,f,c,u,h,v]);return(0,t.jsx)(x.Provider,{value:_,children:(0,t.jsx)(b.TooltipProvider,{delayDuration:0,children:(0,t.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...o},className:(0,n.cn)("group/sidebar-wrapper flex min-h-svh w-full has-data-[variant=inset]:bg-sidebar",i),...l,children:d})})})}function _({side:e="left",variant:a="sidebar",collapsible:s="offcanvas",className:r,children:i,...o}){let{isMobile:d,state:l,openMobile:u,setOpenMobile:h}=v();return"none"===s?(0,t.jsx)("div",{"data-slot":"sidebar",className:(0,n.cn)("flex h-full w-(--sidebar-width) flex-col bg-sidebar text-sidebar-foreground",r),...o,children:i}):d?(0,t.jsx)(c,{open:u,onOpenChange:h,...o,children:(0,t.jsxs)(p,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"w-(--sidebar-width) bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:e,children:[(0,t.jsxs)(m,{className:"sr-only",children:[(0,t.jsx)(g,{children:"Sidebar"}),(0,t.jsx)(f,{children:"Displays the mobile sidebar."})]}),(0,t.jsx)("div",{className:"flex h-full w-full flex-col",children:i})]})}):(0,t.jsxs)("div",{className:"group peer hidden text-sidebar-foreground md:block","data-state":l,"data-collapsible":"collapsed"===l?s:"","data-variant":a,"data-side":e,"data-slot":"sidebar",children:[(0,t.jsx)("div",{"data-slot":"sidebar-gap",className:(0,n.cn)("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===a||"inset"===a?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),(0,t.jsx)("div",{"data-slot":"sidebar-container",className:(0,n.cn)("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex","left"===e?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===a||"inset"===a?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:(0,t.jsx)("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow-sm",children:i})})]})}function w({className:e,onClick:a,...s}){let{toggleSidebar:r}=v();return(0,t.jsxs)(o.Button,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:(0,n.cn)("size-7",e),onClick:e=>{a?.(e),r()},...s,children:[(0,t.jsx)(i,{}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function T({className:e,...a}){let{toggleSidebar:s}=v();return(0,t.jsx)("button",{"data-sidebar":"rail","data-slot":"sidebar-rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:s,title:"Toggle Sidebar",className:(0,n.cn)("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full hover:group-data-[collapsible=offcanvas]:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...a})}function S({className:e,...a}){return(0,t.jsx)("main",{"data-slot":"sidebar-inset",className:(0,n.cn)("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",e),...a})}function I({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:(0,n.cn)("flex flex-col gap-2 p-2",e),...a})}function j({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:(0,n.cn)("flex flex-col gap-2 p-2",e),...a})}function M({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:(0,n.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...a})}function C({className:e,...a}){return(0,t.jsx)("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:(0,n.cn)("flex w-full min-w-0 flex-col gap-1",e),...a})}function k({className:e,...a}){return(0,t.jsx)("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:(0,n.cn)("group/menu-item relative",e),...a})}let R=(0,r.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function E({asChild:e=!1,isActive:a=!1,variant:r="default",size:i="default",tooltip:o,className:d,...l}){let c=e?s.Slot:"button",{isMobile:u,state:h}=v(),p=(0,t.jsx)(c,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":i,"data-active":a,className:(0,n.cn)(R({variant:r,size:i}),d),...l});return o?("string"==typeof o&&(o={children:o}),(0,t.jsxs)(b.Tooltip,{children:[(0,t.jsx)(b.TooltipTrigger,{asChild:!0,children:p}),(0,t.jsx)(b.TooltipContent,{side:"right",align:"center",hidden:"collapsed"!==h||u,...o})]})):p}e.s(["Sidebar",()=>_,"SidebarContent",()=>M,"SidebarFooter",()=>j,"SidebarHeader",()=>I,"SidebarInset",()=>S,"SidebarMenu",()=>C,"SidebarMenuButton",()=>E,"SidebarMenuItem",()=>k,"SidebarProvider",()=>y,"SidebarRail",()=>T,"SidebarTrigger",()=>w,"useSidebar",()=>v],77494)},46827,e=>{"use strict";var t=e.i(54011),a=e.i(85739);let s=(0,a.default)("github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);var r=e.i(50169),i=e.i(57483),n=e.i(4635),o=e.i(19243),d=e.i(28374),l=(0,o.forwardRef)((e,a)=>{let s=(0,d.useAssistantState)(({threads:e,threadListItem:t})=>e.mainThreadId===t.id);return(0,t.jsx)(n.Primitive.div,{...s?{"data-active":"true","aria-current":"true"}:null,...e,ref:a})});l.displayName="ThreadListItemPrimitive.Root";var c=e.i(47463),u=e.i(41619),h=(0,c.createActionButton)("ThreadListItemPrimitive.Archive",()=>{let e=(0,u.useAssistantApi)();return(0,o.useCallback)(()=>{e.threadListItem().archive()},[e])}),p=(0,c.createActionButton)("ThreadListItemPrimitive.Unarchive",()=>{let e=(0,u.useAssistantApi)();return(0,o.useCallback)(()=>{e.threadListItem().unarchive()},[e])}),m=(0,c.createActionButton)("ThreadListItemPrimitive.Delete",()=>{let e=(0,u.useAssistantApi)();return(0,o.useCallback)(()=>{e.threadListItem().delete()},[e])}),g=(0,c.createActionButton)("ThreadListItemPrimitive.Trigger",()=>{let e=(0,u.useAssistantApi)();return(0,o.useCallback)(()=>{e.threadListItem().switchTo()},[e])}),f=({fallback:e})=>{let a=(0,d.useAssistantState)(({threadListItem:e})=>e.title);return(0,t.jsx)(t.Fragment,{children:a||e})};f.displayName="ThreadListItemPrimitive.Title",e.s([],30479),e.i(30479),e.s(["Archive",()=>h,"Delete",()=>m,"Root",()=>l,"Title",()=>f,"Trigger",()=>g,"Unarchive",()=>p],38827);var b=e.i(38827),b=b,x=e.i(64150),v=(0,o.forwardRef)(({onClick:e,disabled:a,...s},r)=>{let i=(0,d.useAssistantState)(({threads:e})=>e.newThreadId===e.mainThreadId),o=(0,u.useAssistantApi)();return(0,t.jsx)(n.Primitive.button,{type:"button",...i?{"data-active":"true","aria-current":"true"}:null,...s,ref:r,disabled:a,onClick:(0,x.composeEventHandlers)(e,()=>{o.threads().switchToNewThread()})})});v.displayName="ThreadListPrimitive.New";var y=e.i(39275),_=e.i(17243),w=({index:e,archived:a,children:s})=>{let r=(0,u.useAssistantApi)(),i=(0,u.useExtendedAssistantApi)({threadListItem:(0,_.DerivedScope)({source:"threads",query:{type:"index",index:e,archived:a},get:()=>r.threads().item({index:e,archived:a})}),on(t,s){let{event:i,scope:n}=(0,y.normalizeEventSelector)(t);return(0,y.checkEventScope)("thread-list-item",n,i)?r.on({scope:"*",event:i},t=>{t.threadId===r.threads().item({index:e,archived:a}).getState().id&&s(t)}):r.on(t,s)}});return(0,t.jsx)(u.AssistantProvider,{api:i,children:s})},T=(0,o.memo)(({index:e,archived:a=!1,components:s})=>{let r=s.ThreadListItem;return(0,t.jsx)(w,{index:e,archived:a,children:(0,t.jsx)(r,{})})},(e,t)=>e.index===t.index&&e.archived===t.archived&&e.components.ThreadListItem===t.components.ThreadListItem);T.displayName="ThreadListPrimitive.ItemByIndex";var S=({archived:e=!1,components:a})=>{let s=(0,d.useAssistantState)(({threads:t})=>e?t.archivedThreadIds.length:t.threadIds.length);return(0,o.useMemo)(()=>Array.from({length:s},(s,r)=>(0,t.jsx)(T,{index:r,archived:e,components:a},r)),[s,e,a])};S.displayName="ThreadListPrimitive.Items";var I=(0,o.forwardRef)((e,a)=>(0,t.jsx)(n.Primitive.div,{...e,ref:a}));I.displayName="ThreadListPrimitive.Root",e.s([],83315),e.i(83315),e.s(["ItemByIndex",()=>T,"Items",()=>S,"New",()=>v,"Root",()=>I],29002);var j=e.i(29002),j=j,M=e.i(65342),M=M;let C=(0,a.default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);var k=e.i(98962),R=e.i(10093),R=R;let E=(0,a.default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]);var A=e.i(93654),N=e.i(55429),L=e.i(25111),P=e.i(99128),z=e.i(77494);let B=()=>{let e=(0,A.usePathname)(),a=(0,A.useRouter)(),{setOpenMobile:s}=(0,z.useSidebar)(),r=e=>{s(!1),a.push(e)};return(0,t.jsxs)(j.Root,{className:"aui-root aui-thread-list-root flex flex-col items-stretch gap-1.5",children:[(0,t.jsxs)(L.Button,{variant:"ghost",className:"flex cursor-pointer items-center justify-start gap-1 rounded-lg px-2.5 py-2 text-start hover:bg-muted data-active:bg-muted",onClick:()=>r("/"),children:[(0,t.jsx)(C,{}),"Chat"]}),(0,t.jsxs)(L.Button,{variant:"ghost",className:"flex cursor-pointer items-center justify-start gap-1 rounded-lg px-2.5 py-2 text-start hover:bg-muted data-active:bg-muted",onClick:()=>r("/models"),children:[(0,t.jsx)(M.default,{}),"Models"]}),(0,t.jsxs)(L.Button,{variant:"ghost",className:"flex cursor-pointer items-center justify-start gap-1 rounded-lg px-2.5 py-2 text-start hover:bg-muted data-active:bg-muted",onClick:()=>r("/tools"),children:[(0,t.jsx)(E,{}),"Tools"]}),"/"===e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Separator,{}),(0,t.jsx)(D,{}),(0,t.jsx)(O,{})]})]})},D=()=>(0,t.jsx)(j.New,{asChild:!0,children:(0,t.jsxs)(L.Button,{className:"aui-thread-list-new flex cursor-pointer items-center justify-start gap-1 rounded-lg px-2.5 py-2 text-start hover:bg-muted data-active:bg-muted",variant:"ghost",children:[(0,t.jsx)(k.PlusIcon,{}),"New Thread"]})}),O=()=>(0,t.jsx)(j.Items,{components:{ThreadListItem:F}}),F=()=>(0,t.jsxs)(b.Root,{className:"aui-thread-list-item flex items-center gap-2 rounded-lg transition-all hover:bg-muted focus-visible:bg-muted focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none data-active:bg-muted",children:[(0,t.jsx)(b.Trigger,{className:"aui-thread-list-item-trigger min-w-0 flex-grow cursor-pointer px-3 py-2 text-start",children:(0,t.jsx)($,{})}),(0,t.jsx)(U,{})]}),$=()=>(0,t.jsx)("span",{className:"aui-thread-list-item-title block max-w-full truncate text-sm",children:(0,t.jsx)(b.Title,{fallback:"New Chat"})}),U=()=>(0,t.jsx)(b.Delete,{asChild:!0,className:"cursor-pointer",children:(0,t.jsx)(N.TooltipIconButton,{className:"aui-thread-list-item-archive mr-3 ml-auto size-4 p-0 text-foreground hover:text-primary",variant:"ghost",tooltip:"Delete thread",children:(0,t.jsx)(R.default,{})})});function V({...e}){return(0,t.jsxs)(z.Sidebar,{...e,children:[(0,t.jsx)(z.SidebarHeader,{className:"aui-sidebar-header mb-2 border-b",children:(0,t.jsx)("div",{className:"aui-sidebar-header-content flex items-center justify-between",children:(0,t.jsx)(z.SidebarMenu,{children:(0,t.jsx)(z.SidebarMenuItem,{children:(0,t.jsx)(z.SidebarMenuButton,{size:"lg",asChild:!0,children:(0,t.jsxs)(i.default,{href:"https://brekkylab.github.io/ailoy",target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)(r.default,{src:"https://brekkylab.github.io/ailoy/img/logo.png",width:32,height:32,alt:"logo"}),(0,t.jsx)("div",{className:"aui-sidebar-header-heading mr-6 flex flex-col gap-0.5 leading-none",children:(0,t.jsx)("span",{className:"aui-sidebar-header-title font-semibold",children:"Ailoy + assistant-ui"})})]})})})})})}),(0,t.jsx)(z.SidebarContent,{className:"aui-sidebar-content px-2",children:(0,t.jsx)(B,{})}),(0,t.jsx)(z.SidebarRail,{}),(0,t.jsx)(z.SidebarFooter,{className:"aui-sidebar-footer border-t",children:(0,t.jsx)(z.SidebarMenu,{children:(0,t.jsx)(z.SidebarMenuItem,{children:(0,t.jsx)(z.SidebarMenuButton,{size:"lg",asChild:!0,children:(0,t.jsxs)(i.default,{href:"https://github.com/brekkylab/ailoy",target:"_blank",children:[(0,t.jsx)("div",{className:"aui-sidebar-footer-icon-wrapper flex aspect-square size-8 items-center justify-center rounded-lg bg-sidebar-primary text-sidebar-primary-foreground",children:(0,t.jsx)(s,{className:"aui-sidebar-footer-icon size-4"})}),(0,t.jsxs)("div",{className:"aui-sidebar-footer-heading flex flex-col gap-0.5 leading-none text-gray-600",children:[(0,t.jsxs)("p",{children:["Powered by"," ",(0,t.jsx)("span",{className:"aui-sidebar-footer-title font-bold text-black",children:"Ailoy"})]}),(0,t.jsx)("span",{children:"View Source"})]})]})})})})})]})}e.s(["ThreadListSidebar",()=>V],46827)},38242,e=>e.a(async(t,a)=>{try{var s=e.i(54011),r=e.i(94739),i=e.i(46092),n=e.i(69798),o=e.i(8355),d=e.i(46827),l=e.i(86444),c=e.i(99128),u=e.i(77494),h=t([n,o,l]);function p({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:`${r.default.variable} ${i.default.variable} antialiased`,children:(0,s.jsx)(n.AiloyAgentProvider,{children:(0,s.jsx)(l.ThreadProvider,{children:(0,s.jsx)(o.AiloyRuntimeProvider,{children:(0,s.jsx)(u.SidebarProvider,{children:(0,s.jsxs)("div",{className:"flex h-dvh w-full pr-0.5",children:[(0,s.jsx)(d.ThreadListSidebar,{}),(0,s.jsxs)(u.SidebarInset,{children:[(0,s.jsxs)("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b px-4",children:[(0,s.jsx)(u.SidebarTrigger,{}),(0,s.jsx)(c.Separator,{orientation:"vertical",className:"mr-2 h-4"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:e})]})]})})})})})})})}[n,o,l]=h.then?(await h)():h,e.s(["default",()=>p]),a()}catch(e){a(e)}},!1)]);